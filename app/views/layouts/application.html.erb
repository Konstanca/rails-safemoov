<!DOCTYPE html>
<html>
  <head>
    <title>RailsSafemoov</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.js" crossorigin="anonymous"></script>
    <%= javascript_importmap_tags %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload", defer: true %>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/dark.css">
  </head>

  <body><%= render "shared/navbar" %>
<%= render "shared/flashes" %>

    <%= yield %>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD-mE_EWkOHFCdCopcKUg62K74OxI1G80I&libraries=places&language=fr"></script>
    <script>
      document.addEventListener("turbo:load", function () {
        const input = document.querySelector("#autocomplete");

        if (!input) return;

        const options = {
          componentRestrictions: { country: "ec" }, // Limite à l’Équateur
          fields: ["formatted_address", "geometry", "name"]
        };

        const autocomplete = new google.maps.places.Autocomplete(input, options);

        autocomplete.addListener("place_changed", () => {
          const place = autocomplete.getPlace();
          console.log("Adresse sélectionnée :", place.formatted_address);
        });
      });
    </script>
  </body>
</html>
