<script>
  document.addEventListener("turbo:load", function() {
    document.querySelectorAll('.toast').forEach(toast => toast.remove());
    toastr.clear();
    <% flash.each do |type, message| %>
      <% toastr_type = { notice: "success", alert: "error" }[type.to_sym] || type %>
      toastr.<%= toastr_type %>("<%= j message %>");
    <% end %>
    // setTimeout(() => {
    //   fetch('/clear_flashes', {
    //     method: 'POST',
    //     headers: { 'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').content }
    //   })
    //   .catch(error => console.error("Erreur lors de la vidange des flashs :", error));
    // }, 100);
  });
</script>
